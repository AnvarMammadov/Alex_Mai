{
    "meta": {
        "version": "1.0.0",
        "locale": "az-AZ",
        "character": {
            "id": "mai",
            "displayName": "Mai",
            "typingDelaysMs": {
                "min": 350,
                "max": 1100
            },
            "availableHours": [ 10, 23 ]
        }
    },

    "nlp": {
        "similarity": {
            "threshold": 0.72,
            "fallbackThreshold": 0.45
        },
        "intents": [
            {
                "id": "greeting",
                "keywords": [ "salam", "hi", "hey", "hello", "selam" ],
                "regex": "(?i)^(salam|hi|hey|hello|selam)\\b"
            },
            {
                "id": "status_chill",
                "keywords": [ "yax≈üƒ±yam", "relaks", "istirah…ôt", "chill", "rahat" ],
                "regex": "(?i)(rahat|relaks|istirah)"
            },
            {
                "id": "woke_up",
                "keywords": [ "indi oyandƒ±m", "yenic…ô oyandƒ±m", "yeni oyandim", "just woke up" ],
                "regex": "(?i)(yeni(c|c…ô)? oyand|just woke)"
            },
            {
                "id": "plan_suggest",
                "keywords": [ "n…ôs…ô ed…ôk", "birlikd…ô", "g√∂r√º≈ü", "g…ôzinti", "film", "plan" ],
                "regex": "(?i)(n[e…ô]s[e…ô] ed[…ôe]k|birl[iƒ±]kd[…ôe]|g[e…ô]zint|film|plan)"
            },
            {
                "id": "relax_home",
                "keywords": [ "evd…ô dinc…ôlir…ôm", "evd…ô", "istirah…ôt evd…ô", "relaks ev" ],
                "regex": "(?i)(evd[…ôe].*din[c√ß][e…ô]l|evd[…ôe] (ol|qal))"
            },
            {
                "id": "teacher_secret",
                "keywords": [ "Terane m√º…ôllim…ô", "T…ôran…ô m√º…ôllim…ô", "mesajlarƒ±mƒ±zƒ± g√∂r√ºr" ],
                "regex": "(?i)(teran[e…ô].*m[u√º][…ôa]llim[e…ô]|mesajlar[iƒ±]m[iƒ±]z[ƒ±i] g[o√∂]r[u√º]r)"
            }
        ]
    },

    "state": {
        "variables": {
            "day": 1,
            "timeOfDay": "morning",
            "affinityMai": 0,
            "flags": {
                "maiSeenStudyMsg": false,
                "playerSuggestedPlan": false,
                "teacherJokeUnlocked": false
            },
            "playerName": "Alex"
        }
    },

    "templates": {
        "greet_back": "Salam, {playerName}! ‚òÄÔ∏è Nec…ôs…ôn?",
        "ask_plans": "Bug√ºn ({timeOfDay}) n…ô planƒ±n var?",
        "affinity_up": "+1 yaxƒ±nlƒ±q üòä",
        "done_study": "Bug√ºnl√ºk oxuma bitdi! ‚ú® N…ô ed…ôk indi?"
    },

    "attachments": {
        "mai_study_photo": {
            "type": "image",
            "path": "res/images/mai_study_desk.png",
            "caption": "D…ôrs bitdi! üìö‚ú®"
        }
    },

    "events": {
        "unlock_cafe_date": {
            "type": "quest",
            "id": "q_cafe_day2",
            "progress": "available"
        },
        "give_small_gift": {
            "type": "flag",
            "name": "giftStickerUnlocked",
            "value": true
        }
    },

    "dialogs": [
        {
            "id": "mai_initial",
            "when": {
                "day": [ 1 ],
                "timeOfDay": [ "morning", "noon", "evening" ]
            },
            "history": [
                {
                    "sender": "Mai",
                    "text": "Hey {playerName}, how are you doing?"
                }
            ],
            "choices": [
                {
                    "playerText": "Hi Mai! I'm good, just relaxing.",
                    "intent": "status_chill",
                    "goTo": "mai_resp_initial_1",
                    "effects": { "affinityMai": { "add": 1 } }
                },
                {
                    "playerText": "Not much, just woke up.",
                    "intent": "woke_up",
                    "goTo": "mai_resp_initial_2"
                },
                {
                    "playerText": "Mesajlarimizi Terane muellime gorur...",
                    "intent": "teacher_secret",
                    "goTo": "mai_resp_terane",
                    "effects": { "flags.teacherJokeUnlocked": true }
                },
                {
                    "playerText": "__free_text__",
                    "fallback": true,
                    "goTo": "mai_resp_generic_hmm"
                }
            ]
        },

        {
            "id": "mai_resp_initial_1",
            "history": [
                {
                    "sender": "Mai",
                    "text": "That's good to hear. üòä What are you up to?"
                }
            ],
            "system": {
                "suggestIntents": [ "plan_suggest", "relax_home" ],
                "cooldownSec": 20
            }
        },

        {
            "id": "mai_resp_initial_2",
            "history": [
                {
                    "sender": "Mai",
                    "text": "Good morning then! üò¥‚òï Yuxunu ala bildin?"
                }
            ],
            "system": { "suggestIntents": [ "plan_suggest", "relax_home" ] }
        },

        {
            "id": "mai_resp_terane",
            "history": [
                {
                    "sender": "Mai",
                    "text": "Salam Terane muellime <3"
                }
            ],
            "system": {
                "onEnter": [ { "event": "give_small_gift" } ]
            }
        },

        {
            "id": "mai_day2_afternoon",
            "when": {
                "day": [ 2 ],
                "timeOfDay": [ "afternoon" ],
                "flags": { "maiSeenStudyMsg": false }
            },
            "history": [
                {
                    "sender": "Mai",
                    "text": "{templates.done_study}"
                },
                { "attachment": "mai_study_photo" }
            ],
            "choices": [
                {
                    "playerText": "Maybe we could do something?",
                    "intent": "plan_suggest",
                    "goTo": "mai_resp_day2_suggest",
                    "effects": {
                        "flags.playerSuggestedPlan": true,
                        "affinityMai": { "add": 1 }
                    }
                },
                {
                    "playerText": "Just planning to relax at home.",
                    "intent": "relax_home",
                    "goTo": "mai_resp_day2_relax",
                    "effects": { "affinityMai": { "add": 0 } }
                },
                {
                    "playerText": "__free_text__",
                    "fallback": true,
                    "goTo": "mai_resp_generic_ok"
                }
            ],
            "system": {
                "onExit": [ { "set": { "flags.maiSeenStudyMsg": true } } ]
            }
        },

        {
            "id": "mai_resp_day2_suggest",
            "history": [
                {
                    "sender": "Mai",
                    "text": "Like what? I'm open to ideas!"
                }
            ],
            "reactiveRoutes": [
                {
                    "match": { "keywords": [ "kafe", "√ßay", "coffee" ] },
                    "onMatch": {
                        "reply": {
                            "sender": "Mai",
                            "text": "Kafe ideyasƒ± g√∂z…ôldir ‚òïÔ∏è yaxƒ±nlarda yeni bir kafe a√ßƒ±lƒ±b!"
                        },
                        "effects": {
                            "event": "unlock_cafe_date",
                            "affinityMai": { "add": 1 }
                        },
                        "end": true
                    }
                },
                {
                    "match": { "keywords": [ "park", "g…ôzinti", "walk" ] },
                    "onMatch": {
                        "reply": {
                            "sender": "Mai",
                            "text": "Parkda g…ôzinti superdir üåø g…ôlin g√ºn batƒ±mƒ±na yeti≈ü…ôk."
                        },
                        "effects": { "affinityMai": { "add": 1 } },
                        "end": true
                    }
                }
            ],
            "fallback": { "goTo": "mai_resp_generic_ok" }
        },

        {
            "id": "mai_resp_day2_relax",
            "history": [
                {
                    "sender": "Mai",
                    "text": "Okay, enjoy your rest! Yen…ô d…ô darƒ±xsan, yaz üòâ"
                }
            ]
        },

        {
            "id": "mai_smalltalk_bank",
            "type": "smalltalk",
            "rules": [
                {
                    "match": { "intent": "greeting" },
                    "responses": [
                        {
                            "sender": "Mai",
                            "text": "{templates.greet_back}"
                        },
                        {
                            "sender": "Mai",
                            "text": "Bug√ºn {timeOfDay} s…ônin ruh halƒ±n nec…ôdir?"
                        }
                    ],
                    "cooldownSec": 60
                },
                {
                    "match": { "keywords": [ "ne edirs…ôn", "n…ô var n…ô yox" ] },
                    "responses": [
                        {
                            "sender": "Mai",
                            "text": "Bir az notlarƒ±mƒ± d√ºz…ônl…ôyir…ôm üìí"
                        },
                        {
                            "sender": "Mai",
                            "text": "S…ônd…ô n…ô var?"
                        }
                    ]
                }
            ]
        },

        {
            "id": "fallbacks",
            "genericHmm": [
                {
                    "sender": "Mai",
                    "text": "Hmm? ü§î"
                },
                {
                    "sender": "Mai",
                    "text": "Tam ba≈üa d√º≈üm…ôdim, bir az a√ßƒ±qlayarsan?"
                }
            ],
            "genericOk": [
                {
                    "sender": "Mai",
                    "text": "Okay."
                },
                {
                    "sender": "Mai",
                    "text": "Qeyd etdim."
                }
            ]
        }
    ],

    "responseMessages": {
        "mai_resp_initial_1": [
            {
                "sender": "Mai",
                "text": "That's good to hear. üòä What are you up to?"
            }
        ],
        "mai_resp_initial_2": [
            {
                "sender": "Mai",
                "text": "Good morning then! Sleep well?"
            }
        ],
        "mai_resp_terane": [
            {
                "sender": "Mai",
                "text": "Salam Terane muellime <3"
            }
        ],
        "mai_resp_day2_suggest": [
            {
                "sender": "Mai",
                "text": "Like what? I'm open to ideas!"
            }
        ],
        "mai_resp_day2_relax": [
            {
                "sender": "Mai",
                "text": "Okay, enjoy your rest!"
            }
        ],
        "mai_resp_generic_hmm": [
            {
                "sender": "Mai",
                "text": "Hmm?"
            }
        ],
        "mai_resp_generic_ok": [
            {
                "sender": "Mai",
                "text": "Okay."
            }
        ]
    }
}
